
### What are Alternate Data Streams (ADS) ?

- ADS stands for "Alternate Data Streams" in Windows. It's a feature of the NTFS (New Technology File System) file system used in Windows operating systems. ADS allows you to attach additional data to a file, which is not part of the main file content but is still associated with it.

- It was also designed to provide compatibility with the Mac OS HFS (Hierarchical File System). 

- Any file created on an NTFS formatted drive will have two different forks/streams: 
	+ Data stream - Default stream that contains the actual data of the file. 
	+ Resource stream - Typically contains the metadata of the file.

- Attackers can use ADS to hide malicious code or executables in legitimate files in order to evade detection.

- This can be done by storing the malicious code or executables in the file attribute resource stream (metadata) of a legitimate file.

- This technique is usually used to evade basic signature based AVs and static scanning tools. 

### How to create an ADS ?

1) We can create `secret.txt` file hidden within a file `test.txt`.
```
notepad test.txt:secret.txt
```

*This will create the file `secret.txt` within the resource stream of `test.txt`. This will essentially be hidden.*

2) The `secret.txt` file can be accessed by using the same command again.

3) Similarly we can copy and hide a malicious executable in the resource stream of a legitimate text file.
```
type payload.exe > logs.txt:backdoor.exe
```

*This will copy the contents of `payload.exe` into `backdoor.exe `which is saved inside the ADS of `logs.txt`*

4) Now we can write some legitimate data inside the `logs.txt` file so that it seems like a legitimate file.

5) We can now create a symbolic link which will run the hidden `backdoor.exe`. To do this, open CMD as administrator and type this command-
```
mklink wupdate.exe C:\Temp\logs.txt:backdoor.exe
```

*Symbolic link is a file system feature that allows you to create a reference or shortcut to a file or directory

6) Symbolic link has been created. Now whenever we'll type `wupdate`. it'll run the `backdoor.exe` file inside the resource stream of `logs.txt`.

7) This will essentially help us bypass the detection of humans, system administrators or very basic signature based antiviruses. 