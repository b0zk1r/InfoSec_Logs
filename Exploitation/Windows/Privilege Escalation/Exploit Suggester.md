
__GitHub__ - https://github.com/AonCyberLabs/Windows-Exploit-Suggester

### How to setup ?

1. To use Windows Exploit Suggester, we first need the target system info.
2. Open a command shell session using `shell` command.
3. Use command `systeminfo` to get the target system information.
4. Copy the output of `systeminfo` into a text file. 
5. The output will also contain the list of `hotfixes` that have been installed on the target computer. 
6. The Windows Exploit Suggester will determine what exploits can be used on the target Windows based on these `hotfixes`.

### How to install and use ?

- Go to the directory where `windows-exploit-suggester.py` is installed.
- On the first run, we won't have MS vulnerability database installed.
- To install the database run the command:
```
windows-exploit-suggester.py --update
```
- This will save the database in a `xls` file, such as `2023-09-19-mssb.xls`
- Run the Python script:
```
./windows-exploit-suggester.py --database <database> --systeminfo <sysinfo-file>
```
- The script will enumerate a list of vulnerabilities that the target Windows is vulnerable to.

*Now that we know what exploits the target system is vulnerable to, we can start finding exploits for privilege escalation.*

### Where to find the exploits ?

Download Exploits - https://github.com/SecWiki/windows-kernel-exploits/

- Now we have a list of vulnerabilities suggested by the script.
- We can now copy the Microsoft Vulnerability ID and perform a Google search on it to learn more about it.
- The `Windows Kernel Exploits` GitHub repository by `SecWiki` is a verifiable source of Windows kernel exploits sorted by CVE and also Microsoft Vulnerability ID.
- We can also go through and verify the source code of each exploit in the repository. 

*Now that we've a legitimate source for downloading exploits, we can go ahead and use them on the target device.*
### How to exploit ?

- Download the `.exe` file of the exploit we want to use from the repository. 
- Navigate into the `temp` directory of the target device using the `meterpreter` session that we already have.
	+ The `temp` directory exists in the root of the C drive.
	+ We can navigate to the C drive with `cd C:\\`
	+ And then to the `temp` directory with `cd Temp\\`
	+ We are using the `temp` directory to avoid being detected, as it is not frequently used by legitimate users in the system.
- Upload the `.exe` file into the `temp` directory with `upload ~/Downloads/exploit.exe`.
- We can now `shell` into the system and `dir` to check if its uploaded successfully.
- Execute the exploit `.\exploit.exe`
- This will provide us with the documentation on how to use the exploit.
- Follow the documentation to use the exploit.
- After exploitation, it'll provide us with a new command shell.
- We can use `whoami` to check the account.
- If the account is `NT AUTHORITY\SYSTEM` then it means that we've __successfully elevated our privileges.__