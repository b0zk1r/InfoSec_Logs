### Windows Configuration Files

- Windows can automate a variety of repetitive tasks, such as the mass roll-out or installation of Windows on many systems.

- This is typically done through the use of the Unattended Windows Setup utility, which is used to automate the mass installation/deployment of Windows on systems.

- This tool utilises configuration files that contain specific configurations and user account credentials, specifically the Administrator account's password.

- If the Unattended Windows Setup configuration files are left on the target system after installation, they can reveal user account credentials that can be used by attackers to authenticate with Windows target legitimately. 

### Unattended Windows Setup

- The Unattended Windows Setup utility will typically utilize one of the following configuration files that contain user account and system configuration information:
	+ `C:\Windows\Panther\Unattend.xml`
	+ `C:\Windows\Panther\Autounattend.xml`

- As a security precaution, the passwords stored in the Unattended Windows Setup configuration file may be encoded in base64, which shouldn't be a hurdle as base64 can be decoded easily.

### Steps to access the config files

1. Gain initial access to the target.
2. Get the username list using `net user`.
3. Navigate to `C:\Windows\Panther\` and find `Unattend.xml`
4. Download the file `download Unattend.xml`
5. `cat` out the content of the file.
6. Scroll down and find the `<AutoLogon>` configuration.
7. If the `<PlainText>` option is set to `false` then the password is encoded in Base64.
8. We can put the password in a text file and decode using `base64 -d pass.txt`
9. Now that we have both the password and username, we can use `psexec.py` to login as NT AUTHORITY/SYSTEM
10. This will successfully get us administrative privileges legitimately. 