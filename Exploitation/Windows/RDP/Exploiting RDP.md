
*Because the default port number for RDP can be modified, it can be challenging to determine the specific port on which RDP is operating.*

### Using `metasploit` to identify the port running RDP

```
use auxiliary/scanner/rdp/rdp_scanner
```

- Run a `nmap` scan and identify a port that can be running RDP
- Set that port number as the LPORT. 

*Now that we've identified the port running RDP, we need to find the credentials to authenticate to the target system via RDP.*

### Using `hydra` to brute-force RDP credentials

```
hydra -L <user-file> -P <pass-file> <target-ip> rdp -s <port>
```

- User file- `/use/share/metasploit-framework/data/wordlists/common_users.txt`
- Pass file - `/use/share/metasploit-framework/data/wordlists/unix_passwords.txt`
- We need to specify the port using `-s` switch or else `hydra` will use the default port.
- In a real world penetration test, we need to be cognisant of the brute-force speed, as it may cause a DOS in the RDP service or we can crash the Windows system, which can be detected. 
- We can limit the brute-force speed using the `-t` task switch. 

*We can now use the credentials found using `hydra` to login using a RDP client. In this case, we'll be using `xfreerdp`.*

### Using a RDP client to login 

```
xfreerdp /u:<username> /p:<password> /v:<target-ip>:<port>
```

- We need to specify the port here, or else `xfreerdp` will use the default port. 