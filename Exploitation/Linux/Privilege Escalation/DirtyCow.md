
### What is Dirty Cow ?

- Dirty COW (CVE-2016-5195) is a privilege escalation vulnerability in the Linux Kernel 
https://github.com/dirtycow/dirtycow.github.io/wiki/VulnerabilityDetails
- We can check if the Linux kernel is vulnerable to Dirty Cow by using `linux-exploit-suggester`

### How to exploit ?

1. Get initial access using `MSF`

2. Install the C exploit file from `ExploitDB` https://www.exploit-db.com/exploits/40839

3. Now the C code `40839.c` needs to be compiled, there are 2 ways we can do this-\
	+ Compile locally in your system.
	+ Compile it in the target machine by uploading the C code. (recommended)

4. To compile the code, we'll need `GCC`. To install GCC - `sudo apt-get install gcc`

5. Rename the code file to `dirty.c` by using `mv 40839.c dirty.c`

6. Now we can compile it- `gcc -pthread dirty.c -o dirty -lcrypt`. If we get no error messages, then it means the compilation was successful. 

7. Now we can upload the compiled binary to the target `upload dirty` if it was compiled locally in the system. 

8. Enter into a `shell` session from the `meterpreter` session. `/bin/bash -i

9. To compile it in the target, we can upload the C code using `meterpreter` and run the `gcc` compilation command in the `shell` session. 

10. After compilation, we'll give executable permissions to the binary `chmod +x dirty`.

11. Run the exploit `./dirty <password-to-set>`. Set a password for the new user to be created.

12. If the exploit ran successfully, we'll see a confirmation message that a user has been created with the password we specified.

13. We can confirm this by seeing the contents of the `passwd`  file - `cat /etc/passwd`

14. `firefart` will be created with root privileges.

15. Now that we have a account with root privileges, we can see the contents of the shadow file. `cat /etc/shadow` and further exploit the target.

