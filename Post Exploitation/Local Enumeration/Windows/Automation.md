
### Automating Windows Local Enumeration

+ In addition to performing local enumeration manually, we can also automate the process with the help of a few scripts and MSF modules.

+ While local enumeration techniques/commands are important to know, as a penetration tester, you will need to be time efficient. As a result, you will need to learn how to utilize various automated enumeration scripts.

+ In addition to automating the process of enumerating information like system information, users & groups etc, these automated enumeration scripts will also provide you with additional information regarding the target system like; privilege escalation vulnerabilities, locally stored passwords etc. 

### Windows Local Enumeration Scripts

+ JAWS - Just Another Windows (Enum) Script - JAWS is PowerShell script designed to help penetration testers (and CTFers) quickly identify potential privilege escalation vectors on Windows systems. It is written using PowerShell 2.0 so 'should' run on every Windows version since Windows 7.

+ GitHub Repo: https://github.com/411Hall/JAWS

### How to perform ?

1. Gain initial access.

2. We can check if the system has any external hard drive connected to it using the `show_mount` command on the `meterpreter` shell.

3. We can use the `win_privs` module to get the privileges of the current user.
```
use post/windows/gather/win_privs
```

5. Using `checkvm` module to check whether the system is a VM. 
```
use post/windows/gather/checkvm
```

6. Enumerating the installed applications and their versions. 
```
use post/windows/gather/enum_applications
```

7. Enumerating the other systems in the network.
```
use post/windows/gather/enum_computers
```

8. Enumerating the list of patches installed.
```
use post/windows/gather/enum_patches
```

### How to use JAWS ?

1. Go to the Github repository of JAWS and copy the code of the `jaws-enum.ps1` PowerShell script.

2. Use a text editor to paste in the code and save it with a `.ps1` extension. (If copy-paste isn't working, we can press `ctrl+shift+alt` keys to open the clipboard and make sure that the text which we copied is there. )

3. Upload the PowerShell script into the target inside the temp folder.

4. Now we can use the system `shell` to execute the PS script.
```
powershell.exe -ExecutionPolicy Bypass -File .\<filename>.ps1 -OutputFilename <file-out>.txt
```
  - This will bypass the Windows execution policy and run the script.
  - This will also save the output of JAWS into a text file to aid in analysis later on.

5. Download the output file using the `meterpreter` shell.