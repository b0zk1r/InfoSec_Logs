
### Upgrading Non-Interactive Shells

1. In this case, we'll be exploiting SAMBA with `is_known_pipename` module in `MSF` to gain a non-interactive command shell session. 

2. The easiest way to identify that a shell is non-interactive is that it doesn't provide us with any prompt. We can perform only very basic tasks with it. 

3. We can upgrade this session to an interactive bash session using `/bin/bash -i`. A bash session is more stable than a normal command shell session. 

4. In some cases, the target system might not have a bash shell installed. In that case, we can use a different shell. Use `cat /etc/shells` to check the list of shells installed in the system. For example, if Bourne shell is installed we can use `/bin/sh -i` to use it.

5. If the target system has Python installed, then we can also use Python to obtain a Bourne or Bash session. We can use `python --version` command to check whether Python is installed. 
```
python -c 'import pty; pty.spawn("/bin/bash")' 
```
- This should provide us with a bash session. 
- Similarly, we can also spawn Bourne session or any other command shell session. 

6. If the target system has Perl installed, we can also use it to obtain a interactive command shell session. We can use `perl --help` command to check whether Perl is installed.
```
perl -e 'exec "/bin/bash";'
```

7. The same can be done if Ruby is installed. 
```
ruby: exec "/bin/bash"
```

8. After obtaining an interactive shell, we should use `env` to display the environment variables. It's recommended to setup the `env` variables for the proper functioning of the interactive shell.

- Setting up the default `PATH` variable. It is the default path that will be used to search for a binary when we type in a command. In our case, it isn't specified.
```
export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
```
- Setting up the `TERM` variable. 
```
export TERM=xterm
```
- Setting up the `SHELL` variable.
```
export SHELL=bash
```

9. After setting up the `env` variables, the interactive shell session should function properly. 